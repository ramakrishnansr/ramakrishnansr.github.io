# Zeek Installation and Configuration for Analyzing Network Traffic with Samba/FTP

This guide provides instructions for installing and configuring Zeek on an Ubuntu system to analyze network traffic generated by a running Apache/Samba/FTP service.

**1. Install Dependencies**

*   Update and upgrade the system:
    ```bash
    sudo apt update
    sudo apt upgrade -y
    ```
*   Install necessary build tools and libraries:
    ```bash
    sudo apt install build-essential cmake libpcap-dev libssl-dev zlib1g-dev 
    ```

**2. Install Samba/FTP Service**

*   **Samba:**
    ```bash
    sudo apt install samba 
    ```
    *   **Configure Samba:** (Refer to the Samba documentation for detailed configuration options)
        *   Create a shared directory and configure access permissions in the `/etc/samba/smb.conf` file.
        *   Start the Samba service:
            ```bash
            sudo systemctl start smbd 
            sudo systemctl enable smbd 
            ```

*   **FTP Server (e.g., vsftpd):**
    ```bash
    sudo apt install vsftpd 
    ```
    *   **Configure vsftpd:** (Refer to the vsftpd documentation for detailed configuration options)
        *   Adjust configuration files (e.g., `/etc/vsftpd.conf`) to define user accounts, permissions, and security settings.
        *   Start the vsftpd service:
            ```bash
            sudo systemctl start vsftpd 
            sudo systemctl enable vsftpd 
            ```
*   **HTTP Server (e.g., Apache/Nginx):**
    *   **Do it yourself!:** Refer to google fot that. Be sure do deploy a basic web app or something for you to generate traffic

**3. Download and Build Zeek**

*    **Importante Note!:** This is a basic tutorial, you can pick to follow it or to follow any other instructions you find on google or LLMs. What is important is that at the end, you have Zeek working

*   Download the latest stable Zeek release:
    ```bash
    wget https://zeek.org/download/zeek-*.tar.gz
    ```
*   Extract the archive:
    ```bash
    tar -xvf zeek-*.tar.gz
    ```
*   Change to the extracted directory:
    ```bash
    cd zeek-*
    ```
*   Configure the build:
    ```bash
    mkdir build
    cd build
    cmake .. 
    ```
*   Build and install Zeek:
    ```bash
    make
    sudo make install
    ```

**4. Configure Zeek**

*   Create a configuration directory:
    ```bash
    sudo mkdir -p /usr/local/etc/zeek/ 
    ```
*   Copy the default configuration file:
    ```bash
    sudo cp local.conf /usr/local/etc/zeek/ 
    ```
*   **Edit `local.conf`:**
    *   Ensure that the `http` and `ftp` sections in the `local.conf` file are uncommented. 
    *   You may need to adjust logging paths or other parameters based on your specific needs.

**5. Start Zeek**

*   Start the Zeek service:
    ```bash
    sudo service zeek start
    ```

**6. Verify Installation and Configuration**

*   Check the Zeek logs for any errors or warnings.
*   Use the `zeekctl` command to interact with the running Zeek instance.
*   Generate some traffic to the HTTP (E.g: Browsing webpages and accessing your local http service, that is, acting as a client and as a server) Samba/FTP service (e.g., file transfers) and observe the corresponding entries in the Zeek logs (e.g., `http.log`, `ftp.log`).

**Zeek-Specific Questions**

**HTTP:**

1.  **How does Zeek differentiate between HTTP requests originating from your local machine and those initiated by other systems on the network?**
2.  **How can you use Zeek to identify and analyze HTTP requests to specific domains or websites?**

**Samba/FTP:**

1.  **What are the key fields in the Zeek `ftp` log that provide information about file transfers, such as file names, sizes, and user credentials?**
2.  **How can you use Zeek to track user activity on the Samba/FTP server, including which files were accessed and by whom?**
3.  **How can you use Zeek to identify potential data exfiltration attempts through the Samba/FTP service?**

**General/Other:**

1.  **How can you use Zeek to identify and analyze DNS queries, including those to known malicious domains?**
2.  **What are some common security-related events that Zeek can help you identify and investigate, beyond those related to HTTP and file transfer protocols?**
3.  **How can you use Zeek to attacks such as Denial Of Service? (Use your DoS Software!)**
4.  **How can you use Zeek to attacks such as Port Scanning? (Use your port scanner Software!)**
5.  **How can you use Zeek to analyze system logs and identify unusual events, such as failed login attempts or system resource exhaustion?**